<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Проверка</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container" id="ct">
<h1 id="h1">Для продолжения, пройдите простой тест, ответив на несколько вопросов</h1>
<p class="subtitle" id="h2">Это нужно для того, чтобы проверить, являетесь ли Вы тем человеком, для кого предназначен этот подарок</p>

<form id="f">
<label>Введите Ваше имя</label>
<input autocomplete="off" id="q1">

<label>Введите Вашу дату рождения</label>
<input autocomplete="off" id="q2">

<label>Кому принадлежит имя Фредди Фазбер?</label>
<input autocomplete="off" id="q3">

<label>Введите ваш любимый вопрос</label>
<input autocomplete="off" id="qfav">

<label>Какая твоя внешняя особенность сильнее всего впечатляет меня?</label>
<input autocomplete="off" id="q4">

<label>Твоя любимая еда, которую ты готова есть каждый день?</label>
<input autocomplete="off" id="q5">

<label>1 + 1</label>
<input autocomplete="off" id="q6">

<button type="submit">Проверить</button>
<p class="error" id="err"></p>
</form>
</div>

<script>
(()=>{
const _0x1f=(s=>crypto.subtle.digest('SHA-256',(new TextEncoder).encode(s)).then(b=>Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,'0')).join('')));

const A={
q1:["8b70f53912519a2c0c63d0853788c7681a5eb2875165e6b2f3896890afc7606f","3acb59306ef6e660cf832d1d34c4fba3bb4c8d51b345f3cfb732f3a930aa3a4f"],
q2:["a2f4baf61a0c2c81a0ec08fc6e359dddb8b27c12075b1219777084ff57ac4b0f","a137c3a05a682abaa31b2c8dc6134c2168e80b04efb5a2c5c1d96df5134115e6"],
q3:["4eb113c77c4a8680bd8f203ca6efb078d39c9c535dc4df03b0ecbecf38fe7cd7","0c7ffb2515c4ad5f79fc3984d409eff9850671c145f0651d71d6217ad36ebb89","d4b2043614d00f90e1aaff42ebc01dd1bac06b9bcbb47c8f7dfcb49117e0a10d","d7c2bff7f75ba87f65532b4f6ad681dfaf11cf3c26dd0eec776f09fe4c9b51a3"],
qfav:["b6eab2d4ddd4170aeb0bdb52e2b6488f346fe5577fab6fd4f8b43980c426a7e4","82b8b0c18c7f98a1f7f20779cd08fae4b2b8f02fd30ed80fa2e06a0873d2a4e0"], 
q4:["b6eab2d4ddd4170aeb0bdb52e2b6488f346fe5577fab6fd4f8b43980c426a7e4"],
q5:["2bb6f081e6e33d7e6443da8932e8def5a0e32766952f4a1517972ed18e8b478d","76e8864c8ad107ac2ffb5f3eeb8000a43d0b2de2ac4f2740d37afb0db1f2fd56"],
q6:["4bf5122f344554c53bde2ebb8cd2b7e3b9c14a9b80bcf5cde84e0e0d0a2f4a11"]
};

const keyParts=["s+GNdoFs9","d23sPMopA85","b9V+1KoDsY","Hq3ie0zUzvW/w="];
const ivParts=["w1XQ00il","uRkWnILJ"];
const ctParts=["9amgs5YSXVItHg2xch5+nC/eHy2H6LJ8vZvCKGqt6daIBF4rQT/YC","V1Xw1ZYTDd1Tr5rPhdOANcIU6EPkX8rqWmCdzQYTjrDoUg81b65AwrEH1wMOs"];
const tg="zovJKTK1UcR5LX8oJBB7Gw==";

function B64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0));}

async function decryptURL(){
let keyStr=keyParts.join(''); 
let iv=B64(ivParts.join(''));
let ct=B64(ctParts.join(''));
let tag=B64(tg);
let full=new Uint8Array(ct.length+tag.length);
full.set(ct,0); full.set(tag,ct.length);
let keyRaw=B64(keyStr);
let key=await crypto.subtle.importKey("raw",keyRaw,{name:"AES-GCM"},false,["decrypt"]);
let url=await crypto.subtle.decrypt({name:"AES-GCM",iv:iv},key,full).then(b=>new TextDecoder().decode(b));
keyParts.length=0; ivParts.length=0; ctParts.length=0;
return url;
}

document.getElementById("f").addEventListener("submit",async e=>{
e.preventDefault();
err.textContent="";
let qs=["q1","q2","q3","qfav","q4","q5","q6"];
for(let q of qs){
let v=document.getElementById(q).value.trim().toLowerCase();
let h=await _0x1f(v);
if(!A[q].includes(h)){
err.textContent="Один или несколько ответов неверны";
return;
}
}

document.getElementById("f").style.display="none";
h1.style.display="none"; h2.style.display="none";
let L=document.createElement("p");
L.className="loading"; L.textContent="Подождите... наши эксперты проверяют ответы";
ct.appendChild(L);

setTimeout(()=>{
L.textContent="Успешно! Подарок твой!";
setTimeout(async()=>{
let U=await decryptURL(); 
L.remove(); window.location.href=U;
},3000);
},5000);
})();
</script>
</body>
</html>
